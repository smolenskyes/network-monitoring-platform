# Network Monitoring Platform

Платформа мониторинга локальной сети предприятия, собранная из микросервисов и вспомогательных сервисов наблюдения. Проект предназначен как базовая заготовка: после запуска docker-compose вы получаете готовый API-шлюз, backend-сервисы, базы данных и статическую панель управления.

## Архитектура

```
┌──────────┐       ┌────────────┐      ┌────────────────┐
│ Frontend │◄──────┤ API Gateway├─────►│ Backend сервисы│
└────┬─────┘       └────┬───────┘      └────┬────────────┘
     │                  │                  │
     │        ┌─────────▼─────────┐ ┌──────▼─────────┐ ┌──────────────┐
     │        │ Auth Service      │ │ Discovery      │ │ Monitoring    │
     │        │ (FastAPI +       │ │ Service        │ │ Service       │
     │        │  PostgreSQL)     │ │ (FastAPI +     │ │ (FastAPI +    │
     │        └──────────────────┘ │  PostgreSQL +  │ │  PostgreSQL + │
     │                              │  Celery + Redis│ │  Celery + Redis)
     │                              └──────┬─────────┘ └──────┬───────┘
     │                                     │                  │
     │                              ┌──────▼────┐      ┌──────▼─────┐
     │                              │ Redis     │      │ Prometheus │
     │                              └───────────┘      │ Grafana    │
     │                                                 └────────────┘
```

* **Frontend** — статическая HTML/CSS/JS панель, отправляющая запросы к API-шлюзу и отображающая устройства, метрики и события.
* **API Gateway** — Nginx, проксирует `/api/auth`, `/api/discovery`, `/api/monitoring` и отдаёт фронтенд.
* **Auth Service** — FastAPI + SQLAlchemy, регистрация/авторизация и выпуск JWT.
* **Discovery Service** — обнаружение устройств и управление инвентарём, фоновые задачи на Celery + Redis.
* **Monitoring Service** — сбор метрик, опрос SNMP и расписание проверок.
* **Инфраструктура** — экземпляры PostgreSQL, Redis, Prometheus и Grafana.

## Структура репозитория

```
api-gateway/          # Конфигурация Nginx API-шлюза
auth-service/         # Микросервис аутентификации (FastAPI)
databases/            # SQL-скрипты инициализации БД
discovery-service/    # Микросервис обнаружения устройств
frontend/             # Статический фронтенд и конфиг Nginx для раздачи
monitoring-service/   # Микросервис мониторинга и обработки метрик
prometheus/, grafana/ # Конфигурация систем мониторинга
redis/                # Конфигурация Redis
```

## Быстрый старт

1. Создайте `.env` на основе примера и при необходимости скорректируйте значения:
   ```bash
   cp .env.example .env
   ```
2. Соберите и запустите инфраструктуру:
   ```bash
   docker compose up --build
   ```
3. После запуска:
   * фронтенд доступен по адресу <http://localhost:3000>;
   * API-шлюз — <http://localhost>;
   * Prometheus — <http://localhost:9090>;
   * Grafana — <http://localhost:3001> (логин/пароль по умолчанию `admin/admin123`).

> ⚠️ По умолчанию в `.env` указан демонстрационный SNMP community `public`. Для production-окружения обязательно замените его.

## Frontend

Фронтенд реализован как статическая одностраничная панель (`frontend/index.html`, `frontend/app.js`, `frontend/styles.css`). JavaScript-код авторизует оператора, получает список устройств, обновляет метрики и позволяет добавлять устройства вручную. Все запросы проходят через API-шлюз и используют существующие backend-сервисы.

## Backend сервисы

Каждый сервис — отдельное FastAPI-приложение с собственным подключением к PostgreSQL. Фоновые задачи планируются Celery и Redis. Основные точки входа находятся в `app/main.py` соответствующих сервисов.

Для локальной разработки можно запускать нужный сервис напрямую, например:
```bash
cd auth-service
uvicorn app.main:app --reload --port 8000
```

## Что дальше

* Замените демонстрационные данные реальным SNMP-опросом устройств.
* Расширьте панель мониторинга графиками Prometheus/Grafana.
* Добавьте систему уведомлений и разграничение ролей пользователей.
